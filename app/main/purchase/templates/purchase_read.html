{% extends "base.html" %}
{% block title %}Purchases{% endblock %}
{% block header %}
<a href="{{ url_for('main.main') }}">Back</a>
<h2>Purchases</h2>
<a href="{{ url_for('main.purchase.purchase_create.purchase_create') }}">Create Purchase</a>
<a href="{{ url_for('main.purchase.supplier.supplier_read.supplier_read') }}">Suppliers</a>
{% endblock %}

{% block content %}
{% for purchase in purchases %}
    <h2>{{ purchase.supplier.name }} <span>{{ purchase.status }}</span></h2>
    <p>Item: {{ purchase.item.name }}</p>
    <p>Order Date: {{ purchase.ordered_date.strftime('%Y-%m-%d') }}</p>
    <p>Weight: {{ "%.2f"|format(purchase.ordered_weight) }} kg</p>
    <p>Expected Date: {{ purchase.expected_date.strftime('%Y-%m-%d') }}</p>
    {% if purchase.received_date %}
    <p>Received Date: {{ purchase.received_date.strftime('%Y-%m-%d') }}</p>
    {% endif %}
    {% if purchase.remarks %}
    <p>Remarks: {{ purchase.remarks }}</p>
    {% endif %}
    
    <a href="{{ url_for('main.purchase.purchase_update.purchase_update', id=purchase.id) }}">Edit</a>
    {% if purchase.status in ['draft', 'ordered'] %}
    <form action="{{ url_for('main.purchase.purchase_delete.purchase_delete', id=purchase.id) }}" method="POST">
        <button type="submit" onclick="return confirm('Are you sure you want to delete this purchase order?')">Delete</button>
    </form>
    {% endif %}
    <hr>
</article>
{% endfor %}
{% if not purchases %}
<p>No purchase found.</p>
{% endif %}
{% endblock %}
{% block scripts %}
{% endblock %}
